<p></p> <br><h2>1、注册<a class="link-info" href="https://huggingface.co/" rel="nofollow" title="Hugging Face">Hugging Face</a> 平台（别忘记上魔法）</h2> <br><h2>2、GitHub CodeSpace的使用</h2> <br><p>        这里使用<a class="link-info" href="https://github.com/codespaces" title="CodeSpace">CodeSpace</a>，在界面下方的终端（terminal）安装以下依赖：</p> <br><pre><code class="hljs"># 安装transformers<br>pip install transformers==4.38<br>pip install sentencepiece==0.1.99<br>pip install einops==0.8.0<br>pip install protobuf==5.27.2<br>pip install accelerate==0.33.0</code></pre> <br><h2>3、下载internlm2_5相关的配置文件</h2> <br><p>       在 /workspaces/codespaces-jupyter 目录下下载模型的配置文件，先新建一个hf_download_josn.py 文件并在这个文件中粘贴以下代码：</p> <br><pre><code class="hljs">touch hf_download_josn.py<br></code></pre> <br><pre><code class="hljs">import os<br>from huggingface_hub import hf_hub_download<br><br># 指定模型标识符<br>repo_id = "internlm/internlm2_5-7b"<br><br># 指定要下载的文件列表<br>files_to_download = [<br>    {"filename": "config.json"},<br>    {"filename": "model.safetensors.index.json"}<br>]<br><br># 创建一个目录来存放下载的文件<br>local_dir = f"{repo_id.split('/')[1]}"<br>os.makedirs(local_dir, exist_ok=True)<br><br># 遍历文件列表并下载每个文件<br>for file_info in files_to_download:<br>    file_path = hf_hub_download(<br>        repo_id=repo_id,<br>        filename=file_info["filename"],<br>        local_dir=local_dir<br>    )<br>    print(f"{file_info['filename']} file downloaded to: {file_path}")</code></pre> <br><p>        运行该文件</p> <br><pre><code class="hljs">python hf_download_josn.py</code></pre> <br><p>        之后下载1.8b模型对应的config.json文件，粘贴下面的代码并运行</p> <br><pre><code class="hljs">touch hf_download_1_8_demo.py</code></pre> <br><pre><code class="hljs">import torch<br>from transformers import AutoTokenizer, AutoModelForCausalLM<br><br>tokenizer = AutoTokenizer.from_pretrained("internlm/internlm2_5-1_8b", trust_remote_code=True)<br>model = AutoModelForCausalLM.from_pretrained("internlm/internlm2_5-1_8b", torch_dtype=torch.float16, trust_remote_code=True)<br>model = model.eval()<br><br>inputs = tokenizer(["A beautiful flower"], return_tensors="pt")<br>gen_kwargs = {<br>    "max_length": 128,<br>    "top_p": 0.8,<br>    "temperature": 0.8,<br>    "do_sample": True,<br>    "repetition_penalty": 1.0<br>}<br><br><br>output = model.generate(**inputs, **gen_kwargs)<br>output = tokenizer.decode(output[0].tolist(), skip_special_tokens=True)<br>print(output)</code></pre> <br><pre><code class="hljs">python hf_download_1_8_demo.py</code></pre> <br><p>        等待几分钟后，会在控制台返回模型生成的结果</p> <br><p style="text-align:center"><img alt="" src="https://i-blog.csdnimg.cn/direct/c4a119a665234411b48f4673eee1046d.bmp" /></p> <br><h2>4、Hugging Face Spaces的使用</h2> <br><p>        首先访问以下链接<a class="link-info" href="https://huggingface.co/spaces" rel="nofollow" title="Hugging Face Spaces"></a>，进入Spaces。在右上角点击Create new Space进行创建，在创建页面中，输入项目名为<code>intern_cobuild</code>，并选择<code>Static</code>应用。创建好项目后，回到我们的CodeSpace，接着clone项目：</p> <br><pre><code class="hljs">cd /workspaces/codespaces-jupyter<br>git clone https://huggingface.co/spaces/guobacool/intern_cobuild<br>cd /workspaces/codespaces-jupyter/intern_cobuild</code></pre> <br><p>        找到该目录文件夹下的index.html文件，修改html代码：</p> <br><pre><code class="hljs"><!doctype html><br><html><br><head><br>  <meta charset="utf-8" /><br>  <meta name="viewport" content="width=device-width" /><br>  <title>My static Space</title><br>  <style><br>    html, body {<br>      margin: 0;<br>      padding: 0;<br>      height: 100%;<br>    }<br>    body {<br>      display: flex;<br>      justify-content: center;<br>      align-items: center;<br>    }<br>    iframe {<br>      width: 430px;<br>      height: 932px;<br>      border: none;<br>    }<br>  </style><br></head><br><body><br>  <iframe src="https://colearn.intern-ai.org.cn/cobuild" title="description"></iframe><br></body><br></html></code></pre> <br><p>        第一次可能会报错：</p> <br><pre><code>remote: Password authentication in git is no longer supported. You must use a user access token or an SSH key instead.</code></pre> <br><p>         需要在Hugging Face创建Access Tokens，点击create new token，创建一个类型为“Write”的token。接着可以在CodeSpace里面，使用</p> <br><pre><code class="hljs">git remote set-url origin https://<name>:<token>@huggingface.co/spaces/<name>/intern_cobuild/</code></pre> <br><p>        然后直接git三步：</p> <br><pre><code class="hljs">git add .<br>git commit -m "update: colearn page"<br>git push</code></pre> <br><p>        如图则成功</p> <br><p><img alt="" src="https://i-blog.csdnimg.cn/direct/ed6b5ff92aa94faa9596f127b67d7993.bmp" />         再次进入Space界面，就可以看见：</p> <br><p style="text-align:center"><img alt="" src="https://i-blog.csdnimg.cn/direct/fbfcbdceda73466db19bac4126c26012.bmp" /></p> <br><h2> 5、模型上传</h2> <br><p>        通过CLI上传 Hugging Face同样是跟Git相关联，通常大模型的模型文件都比较大，因此我们需要安装git lfs，对大文件系统支持。</p> <br><pre><code class="hljs">curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | sudo bash<br>git lfs install <br>pip install huggingface_hub</code></pre> <br><p>         再使用</p> <br><pre><code class="hljs">git config --global credential.helper store<br>huggingface-cli login</code></pre> <br><p>        登录，并按照要求输入token，如下图则成功：</p> <br><p style="text-align:center"><img alt="" src="https://i-blog.csdnimg.cn/direct/8e5c0f6790ca4beca8ddb865e49e73bd.bmp" /></p> <br><p>        最后创建项目，完善项目，用git提交到远程仓库，成果如下图：</p> <br><p style="text-align:center"><img alt="" src="https://i-blog.csdnimg.cn/direct/2d2da585f73e4f8a9b0acbc671b4ca49.bmp" /></p>